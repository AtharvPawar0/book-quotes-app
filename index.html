<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inspiring Book Quotes</title>
    <!-- Tailwind CSS CDN for easy styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Base styles for light mode */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #334155; /* Darker text color */
            transition: background-color 0.3s ease, color 0.3s ease; /* Smooth transition for theme change */
        }
        .quote-container {
            background-color: #ffffff;
            border-radius: 1.5rem; /* More rounded corners */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); /* Deeper shadow */
            padding: 2.5rem; /* More padding */
            max-width: 90%;
            width: 600px;
            text-align: center;
            transition: transform 0.3s ease-in-out, background-color 0.3s ease, box-shadow 0.3s ease;
        }
        .quote-container:hover {
            transform: translateY(-5px); /* Slight lift on hover */
        }
        .quote-text {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 600; /* font-semibold */
            line-height: 1.6;
            margin-bottom: 1.5rem;
            color: #1a202c; /* Even darker for quote */
            transition: color 0.3s ease;
        }
        .quote-source {
            font-size: 1.125rem; /* text-lg */
            font-style: italic;
            color: #64748b; /* Lighter gray for source */
            margin-top: 1rem;
            transition: color 0.3s ease;
        }
        .refresh-button {
            background-color: #4f46e5; /* Indigo */
            color: white;
            padding: 0.875rem 2rem; /* py-3 px-8 */
            border-radius: 0.75rem; /* rounded-xl */
            font-weight: 700; /* font-bold */
            font-size: 1.125rem; /* text-lg */
            cursor: pointer;
            border: none;
            outline: none;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            margin-top: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .refresh-button:hover {
            background-color: #4338ca; /* Darker indigo on hover */
            transform: translateY(-2px);
        }
        .refresh-button:active {
            transform: translateY(0);
            box-shadow: none;
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #4f46e5;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
            display: none; /* Hidden by default */
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text color */
        }
        body.dark-mode .quote-container {
            background-color: #2d3748; /* Darker container */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
        }
        body.dark-mode .quote-text {
            color: #f7fafc; /* Lighter quote text */
        }
        body.dark-mode .quote-source {
            color: #a0aec0; /* Lighter source text */
        }
        body.dark-mode .refresh-button {
            background-color: #667eea; /* Lighter indigo for dark mode button */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.15);
        }
        body.dark-mode .refresh-button:hover {
            background-color: #5a67d8; /* Darker on hover */
        }
        body.dark-mode .loading-spinner {
            border-left-color: #667eea; /* Lighter spinner color */
        }

        /* Theme Toggle Button */
        .theme-toggle-button {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background-color: #cbd5e0; /* Light gray */
            color: #4a5568; /* Dark gray text */
            padding: 0.75rem 1rem;
            border-radius: 9999px; /* Fully rounded */
            font-weight: 600;
            cursor: pointer;
            border: none;
            outline: none;
            transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .theme-toggle-button:hover {
            background-color: #a0aec0; /* Darker gray on hover */
            transform: translateY(-2px);
        }
        .theme-toggle-button:active {
            transform: translateY(0);
            box-shadow: none;
        }
        body.dark-mode .theme-toggle-button {
            background-color: #4a5568; /* Darker gray in dark mode */
            color: #e2e8f0; /* Lighter text in dark mode */
        }
        body.dark-mode .theme-toggle-button:hover {
            background-color: #2d3748; /* Even darker on hover */
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .quote-container {
                padding: 1.5rem;
            }
            .quote-text {
                font-size: 1.5rem; /* text-2xl on smaller screens */
            }
            .quote-source {
                font-size: 1rem; /* text-base on smaller screens */
            }
            .refresh-button {
                padding: 0.75rem 1.5rem; /* py-2 px-6 */
                font-size: 1rem; /* text-base */
            }
            .theme-toggle-button {
                top: 1rem;
                right: 1rem;
                padding: 0.5rem 0.75rem;
                font-size: 0.875rem;
            }
        }
    </style>
</head>
<body>
    <!-- Theme Toggle Button -->
    <button id="themeToggleButton" class="theme-toggle-button">
        <span id="themeIcon">‚òÄÔ∏è</span> <span id="themeText">Light Mode</span>
    </button>

    <div class="quote-container">
        <div id="loadingSpinner" class="loading-spinner"></div>
        <div id="quoteContent" class="hidden">
            <p id="quoteText" class="quote-text">Loading a beautiful quote...</p>
            <p id="quoteSource" class="quote-source">‚Äî Author, *Book Title*</p>
        </div>
        <button id="refreshButton" class="refresh-button">Get New Quote</button>
    </div>

    <script>
        // Get references to DOM elements
        const quoteText = document.getElementById('quoteText');
        const quoteSource = document.getElementById('quoteSource');
        const refreshButton = document.getElementById('refreshButton');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const quoteContent = document.getElementById('quoteContent');
        const themeToggleButton = document.getElementById('themeToggleButton');
        const themeIcon = document.getElementById('themeIcon');
        const themeText = document.getElementById('themeText');
        const body = document.body;

        // Function to apply the selected theme
        function applyTheme(isDarkMode) {
            if (isDarkMode) {
                body.classList.add('dark-mode');
                themeIcon.textContent = 'üåô'; // Moon icon for dark mode
                themeText.textContent = 'Dark Mode';
            } else {
                body.classList.remove('dark-mode');
                themeIcon.textContent = '‚òÄÔ∏è'; // Sun icon for light mode
                themeText.textContent = 'Light Mode';
            }
            // Store the preference in local storage
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
        }

        // Function to fetch a new quote from the backend
        async function fetchQuote() {
            // Show loading spinner and hide content
            loadingSpinner.style.display = 'block';
            quoteContent.classList.add('hidden');
            refreshButton.disabled = true; // Disable button during fetch

            try {
                const response = await fetch('https://my-quotes-api.onrender.com/api/quote');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                // FIX: Await the response.json() call to ensure data is parsed before access
                const data = await response.json();

                // Update the DOM with the new quote
                quoteText.textContent = `"${data.quote}"`;
                quoteSource.textContent = `-- ${data.author}, *${data.book}*`;

            } catch (error) {
                console.error('Failed to fetch quote:', error);
                quoteText.textContent = "Oops! Couldn't load a quote. Please try again later.";
                quoteSource.textContent = ""; // Clear source on error
            } finally {
                // Hide loading spinner and show content
                loadingSpinner.style.display = 'none';
                quoteContent.classList.remove('hidden');
                refreshButton.disabled = false; // Re-enable button
            }
        }

        // Add event listener to the refresh button
        refreshButton.addEventListener('click', fetchQuote);

        // Add event listener to the theme toggle button
        themeToggleButton.addEventListener('click', () => {
            const isDarkMode = body.classList.contains('dark-mode');
            applyTheme(!isDarkMode); // Toggle the theme
        });

        // Fetch a quote and apply saved theme when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Check for saved theme preference
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                applyTheme(true);
            } else {
                applyTheme(false); // Default to light mode if no preference or 'light'
            }
            fetchQuote(); // Fetch the initial quote
        });
    </script>
</body>
</html>
